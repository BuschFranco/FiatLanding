---
import "../styles/global.css";
const { title = "Portuauto | Planes FIAT" } = Astro.props;
---
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content="Descubre los mejores planes FIAT financiados por PorTuAuto. Ofrecemos financiamiento asequible y transparente para tu auto. ¡Contacta hoy mismo!" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet" />
  </head>
  <body>
    <div id="page-loader" class="page-loader"></div>
    <header class="site-header">
      <div class="container header-inner">
        <a href="/" class="brand">
          <img style="width: 12rem;" src="/images/logo.webp" alt="Portuauto" />
        </a>
        <nav class="nav">
          <a href="#planes" style="text-decoration: underline;">Planes <span style="font-weight:600; color:var(--primary)">FIAT</span></a>
          <a href="#contacto" class="btn btn-outline">Contacto</a>
        </nav>
      </div>
    </header>
    <main>
      <slot />
    </main>
    <footer class="site-footer">
      <div class="container footer-inner">
       <a href="/" class="brand">
          <img style="width: 12rem;" src="/images/logo.webp" alt="Portuauto" />
        </a>
        <div class="footer-copy">© {new Date().getFullYear()} Portuauto. Todos los derechos reservados. · <a href="/legal#terminos">Términos y Condiciones</a> · <a href="/legal#privacidad">Políticas de Privacidad</a></div>
      </div>
    </footer>
    <div id="promo-popup" style="position:fixed;bottom:16px;right:16px;z-index:1000;display:none;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.18);overflow:hidden">
      <button class="promo-close" aria-label="Cerrar promoción" title="Cerrar" style="position:absolute;top:6px;right:6px;background:rgba(0,0,0,0.65);color:#fff;border:none;border-radius:999px;width:28px;height:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;line-height:1">×</button>
      <a href="#contacto" aria-label="Ir al formulario de contacto" style="display:block">
        <img src="/images/ad/cronosAd.webp" alt="Promoción FIAT por plan" style="display:block;width:280px;max-width:90vw;height:auto" />
      </a>
    </div>
    <script>
      const l = document.getElementById('page-loader');
      const MIN_MS = 150;
      const TRANS_MS = 700;
      function hide(){ if(l){ l.classList.add('hidden'); setTimeout(()=>{ try{ l.remove(); }catch(_){ } }, TRANS_MS + 50); } }
      if(document.readyState === 'complete') {
        setTimeout(hide, MIN_MS);
      } else {
        const start = performance.now();
        window.addEventListener('load', ()=>{
          const elapsed = performance.now() - start;
          const wait = Math.max(0, MIN_MS - elapsed);
          setTimeout(hide, wait);
        });
      }
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', ()=>{
        document.querySelectorAll('a[href="#contacto"]:not([data-model])')?.forEach(link=>{
          link.addEventListener('click', ()=>{
            const form = document.querySelector('.contact-form');
            const wrap = form?.closest('.container');
            const contactSection = document.getElementById('contacto');
            contactSection?.scrollIntoView({behavior:'smooth', block:'start'});
            wrap?.classList.add('contact-pulse');
            setTimeout(()=>{ wrap?.classList.remove('contact-pulse'); }, 1600);
          });
        });
        const promo = document.getElementById('promo-popup');
        if(promo){
          promo.style.opacity = '0';
          promo.style.transform = 'translateY(12px)';
          promo.style.transition = 'opacity 300ms ease, transform 300ms ease';
          const show = ()=>{ promo.style.display = 'block'; requestAnimationFrame(()=>{ promo.style.opacity = '1'; promo.style.transform = 'translateY(0)'; }); };
          const hide = ()=>{ promo.style.opacity = '0'; promo.style.transform = 'translateY(12px)'; setTimeout(()=>{ promo.style.display = 'none'; }, 320); };
          const closeBtn = promo.querySelector('.promo-close');
          let hideTimer;
          setTimeout(()=>{ show(); hideTimer = setTimeout(()=>{ hide(); }, 8000); }, 3000);
          closeBtn?.addEventListener('click', (ev)=>{ ev.preventDefault(); ev.stopPropagation(); clearTimeout(hideTimer); hide(); });
        }
      });
    </script>
  </body>
  
</html>
